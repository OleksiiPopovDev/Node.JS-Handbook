#### 188. Як у проєктах на Node.js можуть з’явитися вразливості з (на вибір): XSS, Path traversal, SQLI, CSRF? Як від них захищатися?

Вразливості в проєктах на Node.js можуть з'явитися у багатьох місцях, але найчастіше такі уразливості виникають через недостатньо надійне маніпулювання вхідними даними або належну аутентифікацію та авторизацію. Ось пояснення для вибраних вразливостей та способи захисту від них:

### 1. XSS (Cross-Site Scripting)
**Як з'являється:**
- Введення шкідливого JavaScript-коду через поля введення даних користувача (форми, URL, тощо).
- Відображення введеного коду без належного екранування чи валідації.

**Як захиститись:**
- Завжди екрануйте вміст, що відображається в браузері, за допомогою бібліотек для валідації та екранування HTML (наприклад, DOMPurify).
- Уникайте векторів XSS, використовуючи безпечні контексти обробки вашого вмісту, таких як `innerText` замість `innerHTML`.
- Використовуйте заголовки HTTP, такі як Content Security Policy (CSP), щоб обмежити виконання довільного JavaScript.

### 2. Path Traversal
**Як з'являється:**
- Прямий доступ до файлів різних рівнів каталогів за допомогою неподаних данних користувача, таких як "../".

**Як захиститись:**
- Використовуйте безпечні API для маніпулювання шляхами до файлів (наприклад, path.resolve у Node.js).
- Обмежуйте доступні файли лише на дозволених каталогах.
- Виконуйте валідацію та нормалізацію шляхів до файлів перед здійсненням дій з боку сервера.

### 3. SQLI (SQL Injection)
**Як з'являється:**
- Включення користувацького введення в SQL-запити без належної екранізації чи використання параметризованих запитів.

**Як захиститись:**
- Використовуйте підготовлені запити та ORM-інструменти, такі як Sequelize, які автоматично враховують екранування SQL-запитів.
- Ніколи не включайте дані користувача безпосередньо в запити SQL.
- Застосовуйте валідацію та фільтрування вхідних даних на стороні сервера.

### 4. CSRF (Cross-Site Request Forgery)
**Як з'являється:**
- Зловмисник може змусити браузер користувача виконати небажаний запит до веб-додатка, в який вони вже авторизовані.

**Як захиститись:**
- Використовуйте CSRF-токени, які потрібно включити в кожен запит, що змінює стан.
- Використовуйте SameSite атрибут для кукіз, щоб обмежити їх використання скриптами з іншого походження.
- Валідуйте походження запитів, які надходять на сервер, через заголовки Origin або Referer.

Застосування цих практик може значно підвищити безпеку вашого Node.js проєкту та захистити його від більшості поширених уразливостей.

| Back | Forward |
|---|---|
| [Наведіть найкращі практики для обробки помилок в асинхронному коді.](/ua/strong-middle/questions-for-an-application-programmer-on-nodejs/187-what-are-best-practices-for-handling-errors-in-asynchronous-code.md)  | [Як можливі race conditions при асинхронному програмуванні?](/ua/strong-middle/questions-for-an-application-programmer-on-nodejs/what-are-possible-race-conditions-in-asynchronous-programming.md) |