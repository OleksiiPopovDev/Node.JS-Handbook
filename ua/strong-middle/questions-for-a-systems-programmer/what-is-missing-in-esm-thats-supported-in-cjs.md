#### 168. Чого не вистачає у ESM, що підтримується у CJS?

У системі модулів ECMAScript (ESM) є кілька аспектів, які відрізняються від CommonJS (CJS) і можуть вважатися недоліками для тих, хто звик працювати з CJS. До таких аспектів належать:

1. **Синхронне завантаження модулів**: 
   - CJS модули імпортуються синхронно, що може бути зручним для деяких застосунків. У ESM імпорт модулів завжди асинхронний, що може вплинути на спосіб написання коду.

2. **Динамічний імпорт**:
   - CJS дозволяє імпортувати модулі будь-де в коді умовно (наприклад, всередині функцій чи умов). У ESM для умовного імпортування потрібно використовувати `import()`, що повертає проміс.

3. **Об'єкт `require`**:
   - У CJS є об'єкт `require`, який можна використовувати для динамічного завантаження модулів, обчислювального імпорту або умовного імпорту в каскадних файлових структурах. У ESM `import` працює більше як декларативна конструкція без повної гнучкості, яку дає `require`.

4. **Імпорт JSON файлів**:
   - У CJS можливо напряму імпортувати JSON файли, у той час як у ESM це вимагає більше налаштувань або трансформацій з використанням інструментів, таких як Babel.

5. **Замикання та контекст модуля**:
   - CJS модулі обгорнуті у функціональне замикання, що надає їм власний контекст виконання. У ESM такої конструкції немає, бо вони працюють у глобальній області видимості модуля.

6. **Можливість експорту через `module.exports`**:
   - CJS підтримує експортування за допомогою `module.exports`, що дозволяє експортувати одну функцію або об'єкт напряму. ESM використовує `export default` або іменований експорт, що вимагає дещо іншого підходу.

Кожен з цих аспектів може вимагати змін у коді під час міграції з CJS на ESM, а також може впливати на вибір підходу до архітектури системи залежно від потреб вашого проєкту.

| Back | Forward |
|---|---|
| [Як пов’язані node:async_hooks і AsyncLocalStorage?](/ua/strong-middle/questions-for-a-systems-programmer/what-is-the-relationship-between-nodeasynchooks-and-asynclocalstorage.md)  | [Як стежити за змінами файлів і директорій на диску? Які з цим можуть виникати проблеми?](/ua/strong-middle/questions-for-a-systems-programmer/how-to-monitor-changes-of-files-and-directories-on-the-disk-what-problems-may-arise-with-this.md) |