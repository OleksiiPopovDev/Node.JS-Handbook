#### 162. Чому Node.js не однопотоковий? Доведіть, що він ніколи не був однопотоковим?

Node.js часто описують як однопотокову платформу, але ця характеристика стосується головним чином виконання JavaScript-коду. Фактично, Node.js використовує кілька потоків для різних операцій, щоб ефективно обробляти асинхронні задачі. Ось кілька аргументів, що підтверджують, що Node.js ніколи не був повністю однопотоковим:

1. **Libuv та Event Loop**: Node.js використовує бібліотеку libuv для реалізації подійної моделі обробки вводу/виводу. Libuv створює пул потоків (thread pool) для виконання операцій, які не можна виконувати асинхронно на системному рівні. Наприклад, файлові операції в Node.js можуть використовувати ці додаткові потоки.

2. **Пул потоків**: За замовчуванням, libuv створює пул з чотирьох потоків, який використовується для паралельного виконання задач, таких як обробка DNS-запитів чи доступ до файлової системи. Це дозволяє виконувати певні завдання паралельно без блокування основного потоку, в якому виконується JavaScript.

3. **Асинхронні API**: Багато API в Node.js працюють асинхронно і не блокують основний потік. Це досягається за рахунок використання пулу потоків або системних викликів, що підтримують асинхронний режим.

4. **Обробка HTTP/HTTPS запитів**: Сервери на базі Node.js можуть обробляти тисячі запитів завдяки асинхронній обробці, де різні частини запиту можуть оброблятись в різних потоках до завершення виконання.

5. **Worker Threads**: З Node.js версії 10.5.0 була додана підтримка Worker Threads, що дозволяє створювати повноцінні багатопотокові програми з декількома виконавцями JavaScript-коду, які працюють в окремих потоках.

6. **Модулі на C/C++**: Багато модулів Node.js використовують нативний C/C++ код, який може створювати і використовувати додаткові потоки для виконання задач.

Таким чином, хоча саминй JavaScript в Node.js виконується в одному потоці (основний потік), під капотом взаємодія з системними ресурами реалізована багатопотоково для забезпечення ефективності та можливості обробки великої кількості асинхронних операцій.

| Back | Forward |
|---|---|
| [Які ви знаєте вбудовані засоби серіалізації у Node.js, аналогічні до JSON, але для бінарної серіалізації?](/ua/strong-middle/questions-for-a-systems-programmer/what-builtin-serialization-utilities-in-nodejs-are-similar-to-json-but-for-binary-serialization.md)  | [Чим замінити deprecated: fs.exists?](/ua/strong-middle/questions-for-a-systems-programmer/what-to-replace-deprecated-fsexists.md) |